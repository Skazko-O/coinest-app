import { useLoginForm } from "../hooks/useLoginForm";
import Button from 'react-bootstrap/Button';
import Form from 'react-bootstrap/Form';
import { useNavigate } from 'react-router-dom';
import { mockUsers } from '../data/mockUsers';
import { showToast } from '../utils/toast';

export default function LoginForm() {

    const navigate = useNavigate();

    const {
        register,
        handleSubmit,
        formState: { errors }
    } = useLoginForm();

    const onSubmit = (data) => {
        const user = mockUsers.find(
            (u) => u.email === data.email && u.password === data.password
        );
        if (user) {
            showToast.success('Login successful!');
            localStorage.setItem('auth', JSON.stringify(user));

            // if (data.rememberMe){
            //     localStorage.setItem('rememberedEmail', data.email);
            //     localStorage.setItem('rememberedPasword', btoa(data.password));
            // }
            // else {
            //     localStorage.removeItem('rememberedEmail');
            //     localStorage.removeItem('rememberedPasword');
            // }
            
            navigate('/');
        } else {
            showToast.error('Invalid email or password');
        }        
    }

    return (
        <>
            <div className='circle-sm'></div>
            <div className='circle-midl'></div>
            <div className='circle-high'></div>
            <div className="svg-top-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="865" height="720" viewBox="0 0 865 720" fill="none">
                    <path d="M257.5 139C121.9 151.8 29.6667 51 0.5 -1L864.5 2.5V720.5H768C469.2 682.5 519.5 531 582 460C618.5 410.167 684.5 290.1 656.5 208.5C621.5 106.5 427 123 257.5 139Z" fill="#D6EFC7" />
                </svg>
            </div>
            <div className="form-wrapper">
                <div className="logo-top">
                    <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 22 22" fill="none">
                        <path fillRule="evenodd" clipRule="evenodd" d="M3.27863 12.0786C1.36022 12.8222 0 14.6856 0 16.8667C0 19.7017 2.29827 22 5.13333 22C7.31439 22 9.17775 20.6398 9.92138 18.7214L3.27863 12.0786Z" fill="#1E4841" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M15.012 12.0786C13.0936 12.8222 11.7334 14.6856 11.7334 16.8667C11.7334 19.7017 14.0317 22 16.8667 22C19.0478 22 20.9111 20.6398 21.6548 18.7214L15.012 12.0786Z" fill="#1E4841" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M15.012 0C13.0936 0.743632 11.7334 2.60699 11.7334 4.78804C11.7334 7.62311 14.0317 9.92138 16.8667 9.92138C19.0478 9.92138 20.9111 8.56116 21.6548 6.64275L15.012 0Z" fill="#1E4841" />
                        <path fillRule="evenodd" clipRule="evenodd" d="M3.27863 0.345276C1.36022 1.08891 0 2.95227 0 5.13332C0 7.96838 2.29827 10.2667 5.13333 10.2667C7.31439 10.2667 9.17775 8.90643 9.92138 6.98802L3.27863 0.345276Z" fill="#1E4841" />
                    </svg>
                </div>
                <div className="name-top">
                    <svg xmlns="http://www.w3.org/2000/svg" width="176" height="114" viewBox="0 0 76 14" fill="none">
                        <path d="M76 0.53479V3.07842H72.2029V13.4373H69.6593V3.07842H65.8623V0.53479H76Z" fill="#242E2C" />
                        <path d="M59.7078 13.6769C58.9828 13.6769 58.2885 13.5632 57.625 13.3359C56.9676 13.1085 56.39 12.7798 55.8924 12.3498C55.4008 11.9197 55.0476 11.4097 54.8325 10.8199L57.2195 9.93515C57.2932 10.1441 57.4468 10.3407 57.6803 10.525C57.9138 10.7032 58.2056 10.8506 58.5558 10.9674C58.906 11.0779 59.29 11.1332 59.7078 11.1332C60.1072 11.1332 60.482 11.0749 60.8322 10.9581C61.1885 10.8353 61.4742 10.6663 61.6893 10.4513C61.9104 10.2362 62.021 9.98431 62.021 9.69554C62.021 9.40677 61.9074 9.16715 61.68 8.97668C61.4527 8.78622 61.1609 8.63569 60.8045 8.5251C60.4482 8.40836 60.0826 8.31927 59.7078 8.25783C58.7801 8.12266 57.9475 7.90455 57.2103 7.60349C56.4791 7.29629 55.9016 6.87542 55.4776 6.34089C55.0537 5.80022 54.8417 5.11516 54.8417 4.28572C54.8417 3.48699 55.066 2.78964 55.5145 2.19367C55.9692 1.5977 56.5651 1.13383 57.3024 0.802049C58.0459 0.470271 58.8476 0.304382 59.7078 0.304382C60.4205 0.304382 61.1087 0.418047 61.7722 0.645377C62.4358 0.872705 63.0133 1.20141 63.5048 1.63149C64.0025 2.06158 64.3588 2.57767 64.5739 3.17979L62.1869 4.0461C62.1132 3.8372 61.9596 3.64366 61.7261 3.46549C61.4927 3.28731 61.2008 3.14293 60.8506 3.03233C60.5004 2.92174 60.1195 2.86644 59.7078 2.86644C59.3146 2.8603 58.9398 2.91867 58.5835 3.04155C58.2332 3.16443 57.9445 3.33339 57.7171 3.54843C57.496 3.76347 57.3854 4.00923 57.3854 4.28572C57.3854 4.64821 57.4898 4.92162 57.6987 5.10594C57.9138 5.29027 58.1964 5.42236 58.5466 5.50223C58.8968 5.58211 59.2839 5.65276 59.7078 5.7142C60.5803 5.84323 61.3851 6.07363 62.1224 6.40541C62.8597 6.73104 63.4495 7.16727 63.8919 7.71409C64.3404 8.25476 64.5647 8.91524 64.5647 9.69554C64.5647 10.4943 64.3404 11.1916 63.8919 11.7876C63.4434 12.3836 62.8505 12.8474 62.1132 13.1792C61.3759 13.511 60.5741 13.6769 59.7078 13.6769Z" fill="#242E2C" />
                        <path d="M44.8289 13.4373V0.53479H52.9943V3.07842H47.3725V5.25341H51.7593V7.79704H47.3725V10.8936H52.9943V13.4373H44.8289Z" fill="#242E2C" />
                        <path d="M32.3008 13.4373V0.53479H35.0472L40.0791 8.83845V0.53479H42.6228V13.4373H39.8764L34.8444 5.1336V13.4373H32.3008Z" fill="#242E2C" />
                        <path d="M27.2673 13.4373V0.53479H29.811V13.4373H27.2673Z" fill="#242E2C" />
                        <path d="M19.0131 13.6769C18.1407 13.6769 17.3204 13.5048 16.5524 13.1608C15.7844 12.8106 15.1086 12.3283 14.5249 11.7139C13.9412 11.0994 13.4835 10.3898 13.1517 9.58494C12.8199 8.77393 12.6541 7.90762 12.6541 6.98602C12.6541 6.06441 12.8199 5.20118 13.1517 4.39631C13.4835 3.5853 13.9412 2.87259 14.5249 2.25818C15.1086 1.64378 15.7844 1.16455 16.5524 0.820481C17.3204 0.470271 18.1407 0.295166 19.0131 0.295166C19.8917 0.295166 20.715 0.470271 21.483 0.820481C22.251 1.16455 22.9269 1.64378 23.5106 2.25818C24.0942 2.87259 24.5489 3.5853 24.8745 4.39631C25.2063 5.20118 25.3722 6.06441 25.3722 6.98602C25.3722 7.90762 25.2063 8.77393 24.8745 9.58494C24.5489 10.3898 24.0942 11.0994 23.5106 11.7139C22.9269 12.3283 22.251 12.8106 21.483 13.1608C20.715 13.5048 19.8917 13.6769 19.0131 13.6769ZM19.0131 11.1332C19.5354 11.1332 20.0269 11.0257 20.4877 10.8107C20.9485 10.5895 21.354 10.2884 21.7042 9.90751C22.0544 9.52658 22.3278 9.08728 22.5244 8.58961C22.7272 8.09194 22.8286 7.55741 22.8286 6.98602C22.8286 6.41462 22.7272 5.88009 22.5244 5.38242C22.3278 4.87861 22.0544 4.43932 21.7042 4.06453C21.354 3.6836 20.9485 3.38561 20.4877 3.17057C20.0269 2.94939 19.5354 2.83879 19.0131 2.83879C18.4909 2.83879 17.9994 2.94939 17.5386 3.17057C17.0778 3.38561 16.6722 3.6836 16.322 4.06453C15.9718 4.44546 15.6953 4.88476 15.4926 5.38242C15.296 5.88009 15.1977 6.41462 15.1977 6.98602C15.1977 7.55741 15.296 8.09502 15.4926 8.59883C15.6953 9.09649 15.9718 9.53579 16.322 9.91672C16.6722 10.2915 17.0778 10.5895 17.5386 10.8107C17.9994 11.0257 18.4909 11.1332 19.0131 11.1332Z" fill="#242E2C" />
                        <path d="M6.34064 13.6769C5.46819 13.6769 4.64796 13.5048 3.87996 13.1608C3.11195 12.8106 2.43611 12.3283 1.85243 11.7139C1.27489 11.0994 0.820228 10.3898 0.488451 9.58494C0.162817 8.77393 0 7.90762 0 6.98602C0 6.05827 0.162817 5.19196 0.488451 4.38709C0.820228 3.57608 1.27489 2.86644 1.85243 2.25818C2.43611 1.64378 3.11195 1.16455 3.87996 0.820481C4.64796 0.470271 5.46819 0.295166 6.34064 0.295166C7.38513 0.295166 8.34667 0.537855 9.22526 1.02323C10.1039 1.50247 10.8319 2.14452 11.4095 2.94939L9.14232 4.17512C8.79825 3.76962 8.38353 3.44705 7.89815 3.20744C7.41277 2.96168 6.8936 2.83879 6.34064 2.83879C5.8184 2.83879 5.32688 2.94632 4.86607 3.16136C4.40527 3.3764 3.99976 3.67438 3.64955 4.05531C3.30549 4.43624 3.03515 4.87554 2.83854 5.37321C2.64193 5.87088 2.54363 6.40848 2.54363 6.98602C2.54363 7.55741 2.64193 8.09502 2.83854 8.59883C3.03515 9.09649 3.30549 9.53579 3.64955 9.91672C3.99976 10.2915 4.40527 10.5895 4.86607 10.8107C5.32688 11.0257 5.8184 11.1332 6.34064 11.1332C6.89975 11.1332 7.41892 11.0104 7.89815 10.7646C8.38353 10.5188 8.79825 10.1932 9.14232 9.78769L11.4095 11.0226C10.8319 11.8214 10.1039 12.4634 9.22526 12.9488C8.34667 13.4342 7.38513 13.6769 6.34064 13.6769Z" fill="#242E2C" />
                    </svg>
                </div>
                <Form onSubmit={handleSubmit(onSubmit)}>
                    <Form.Group className="mb-3" controlId="formBasicEmail">
                        <Form.Label>Email address</Form.Label>
                        <Form.Control
                            type="email"
                            placeholder="Enter email"
                            {...register('email', {
                                required: 'Email is required',
                                pattern: {
                                    value: /^\S+@\S+$/i,
                                    message: 'Invalid email format'
                                }
                            })}
                            isInvalid={!!errors.email}
                        />
                        <Form.Control.Feedback type="invalid">
                            {errors.email?.message}
                        </Form.Control.Feedback>
                    </Form.Group>

                    <Form.Group className="mb-3">
                        <Form.Label>Password</Form.Label>
                        <Form.Control
                            type="password"
                            placeholder="Password"
                            {...register('password', {
                                required: 'Password is required',
                                minLength: {
                                    value: 6,
                                    message: 'Minimum length is 6 characters'
                                }
                            })}
                            isInvalid={!!errors.password}
                        />
                        <Form.Control.Feedback type="invalid">
                            {errors.password?.message}
                        </Form.Control.Feedback>
                    </Form.Group>

                    {/* <Form.Group className="mb-3">
                        <Form.Check
                            type="checkbox"
                            label="Remember me"
                            {...register('rememberMe')}
                        />
                    </Form.Group> */}

                    <Button variant="primary" type="submit" className="w-100">
                        LOGIN
                    </Button>
                </Form>
            </div>
        </>
    );
}